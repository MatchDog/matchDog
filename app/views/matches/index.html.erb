<script type="text/javascript">

</script>

<div class="row-fluid">
    <div id="side-matches" class="col-md-6">
        <span class="title-session glyphicon glyphicon-fire"></span><span class="title-session">Meus Matches ;)</span>
        <hr> 
        <div id="matches">
          
        <% @matches.each  do |m| %>
         
        <div id="match-<%= m.id %>" class="one-match">
            <span class="title-date glyphicon glyphicon-fire"></span><span class="title-date"> Match em <%= m.created_at %></span>
            <div class="row-fluid">
                <div class="col-sm-3 foto-me-and-dog">  
                    <% if !current_user.foto.nil? %>
                    <img class="mini-me" src="/images/<%= current_user.foto.url %>"> 
                    <% else %>    
                    <%= image_tag "dono_default_image.png", class: "mini-me" %> 
                    <% end %>  
                    <% if !m.dog2.foto.nil? %>
                    <img class="mini-dog" src="/images/<%= m.dog2.foto.url %>">  
                    <% else %>    
                    <%= image_tag "dog_default_image.png", class: "mini-dog" %> 
                    <% end %>   
                </div>
                <div class="col-sm-1 versus">
                    <span class="title-session">X</span>
                </div>
                <div class="col-sm-2 foto-alvo-mini match-dog">
                    <a href="/album/dog/<%= m.dog2.id %>" class="fancybox fancybox.ajax">
                        <span class="glyphicon glyphicon-camera"></span>
                        <%= image_tag "dog_default_image.png" %>
                    </a>
                    <%= m.dog2.nome %>
                </div>
                <div class="col-sm-2 foto-alvo-mini match-dono">
                    <a href="/album/dono/<%= m.dog2.id %>" class="fancybox fancybox.ajax">
                        <span class="glyphicon glyphicon-camera"></span>
                        <% if !m.dog2.dono.foto.nil? %>
                    <img class="mini-me" src="/images/<%= m.dog2.dono.foto.url %>"> 
                    <% else %>    
                    <%= image_tag "dono_default_image.png", class: "mini-me" %> 
                    <% end %>
                    </a>
                    <%= m.dog2.dono.nome %>
                </div>
                <div class="col-sm-3">
                <!--
                   <a href="/latidas/domatch/<%= m.id %>" class="fancybox fancybox.ajax btn btn-success form-control"><span class="glyphicon glyphicon-comment"></span>Latir</a>
                -->  
                   <button id="singlebutton" name="singlebutton" class="btn btn-success form-control bt-latir"><span class="glyphicon glyphicon-comment"></span> Latir</button>
                   <hr style="margin-top: 7px;  margin-bottom: 7px;">
                   <button id="singlebutton" name="singlebutton" class="btn btn-danger form-control"><span class="glyphicon glyphicon-remove-circle"></span> ñ rola +</button>
                </div>
            </div>
            <div class="col-sm-12"><hr></div>
        </div>
        
        <% end %>
        </div><!--matches-->
        
    </div>
    
    
    <div id="side-latidas" class="col-md-6">
        <div id="box-latidas" class="col-md-12">
            <a href="#" title="ocultar" class="ocultar"><span class="glyphicon glyphicon-eye-close"></span></a>
            <div id="ponta-box"></div>
            <div id="latidas">
                <div id="one-latida" class="latida-left col-md-11"> 
                    isto é uma latida da outra pessoa
                    <span class="data-envio">enviada em 12/07/15 15:02</span>
                    <div class="seta-esquerda"></div>
                </div>
                <div id="one-latida" class="latida-right col-md-11"> 
                    isto é uma latida MINHA <br>
                    teste<br>
                    <span class="data-envio">enviada em 12/07/15 15:00</span>
                    <div class="seta-direita"></div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-11 col-padding-reduce">
                    <textarea name="msg" placeholder="au au!" class="form-control" rows="2" cols="50"></textarea>
                </div>
                <div class="col-sm-1 col-padding-reduce">
                    <button id="singlebutton" name="singlebutton" class="btn btn-success form-control"><span class="glyphicon glyphicon-comment"></span> Latir</button>
                </div>
            </div>
        </div><!--fim box latidas-->

    </div>
    
    
    <!--carregar via ajax-->
    <div style="display:none;">
      
    </div>
</div>
<script>
$(document).ready(function() {
   
       $('.foto-alvo-mini').mouseover(function() {
        $( this ).find( ".glyphicon-camera" ).show();
      })
      .mouseout(function() {
        $( this ).find( ".glyphicon-camera" ).hide();
      });
      
      $('.ocultar').click(function() {
        $('#box-latidas').fadeOut();
        $('.one-match').removeClass('inativo');
        $('.bt-latir').removeClass('inativo');
      });
      
      $('.bt-latir').click(function() {
        $(this).addClass('inativo');
        $('#box-latidas').fadeIn();
        //$('#latidas').empty();
        $('#latidas').append("carregar latidas match: "+ //apagar isto depois que ajax for feito
            $(this).parents('[id^="match-"]').attr('id').split('-')[1] //VEJA AQUI COMO PEGAR O ID DO MATCH!!!!!!!!!!!!!
        );
        
        //inativo todos para depois ativar somente o this
        $('.one-match').addClass('inativo');
        $(this).parents('.one-match').removeClass('inativo');
        
        //movendo o match clicado para o topo da lista CASO NAO SEJA O PRIMEIRO
        if($('#matches').children().first()[0] === $(this).parents('.one-match')[0]){
           //já está no topo, não precisa mover a div
        }else{
            $('#matches').children().first().animateAppendTo('#matches', 1000);//tirando o atual
            $(this).parents('.one-match').animatePrependTo('#matches', 500);//colocando o novo no topo
        }
      });
});
</script>